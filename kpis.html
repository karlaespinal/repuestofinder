<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>KPIs + Tabla Din√°mica</title>

<style>
:root{
  --bg:#f6f7fb;
  --card:#fff;
  --line:#e5e7eb;
  --txt:#0f172a;
  --mut:#64748b;
  --pri:#2563eb;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family: Arial, Helvetica, sans-serif;
  background:var(--bg);
  color:var(--txt);
}

.page{
  padding:16px;
  height:100vh;
  display:flex;
  flex-direction:column;
  gap:14px;
}

/* =================== BLOQUES SUPERIORES =================== */
.topGrid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:14px;
}

.block{
  background:var(--card);
  border:1px solid var(--line);
  border-radius:16px;
  padding:14px;
  min-height:180px;
}

.block h3{
  margin:0 0 8px;
  font-size:15px;
  font-weight:900;
}

.placeholder{
  border:2px dashed #cbd5f5;
  border-radius:12px;
  height:120px;
  display:flex;
  align-items:center;
  justify-content:center;
  color:var(--mut);
  font-weight:700;
}

/* =================== TABLA =================== */
.tableWrap{
  flex:1;
  background:var(--card);
  border:1px solid var(--line);
  border-radius:18px;
  padding:12px;
  display:flex;
  flex-direction:column;
  overflow:hidden;
}

.tableActions{
  display:flex;
  gap:8px;
  margin-bottom:10px;
}

.btn{
  border:0;
  border-radius:10px;
  padding:8px 12px;
  font-weight:900;
  cursor:pointer;
}

.btnPrimary{
  background:var(--pri);
  color:#fff;
}

/* Scroll horizontal */
.tableScroll{
  overflow:auto;
  flex:1;
}

/* Grid estilo Excel */
.grid{
  display:grid;
  grid-auto-flow:column;
  grid-auto-columns:160px;
  min-width:max-content;
}

/* Columnas */
.col{
  border-right:1px solid var(--line);
}

/* Header */
.colHeader{
  background:#f1f5f9;
  padding:8px;
  font-weight:900;
  cursor:grab;
  border-bottom:1px solid var(--line);
}

/* Celdas */
.cell{
  padding:6px 8px;
  min-height:28px;
  border-bottom:1px solid var(--line);
}
.cell:focus{
  outline:none;
  background:#eef2ff;
}
</style>
</head>

<body>

<div class="page">

  <!-- BLOQUES -->
  <div class="topGrid">
    <div class="block">
      <h3>üìä Reporte de B√∫squedas</h3>
      <div class="placeholder">Gr√°ficos por fecha / marca</div>
    </div>
    <div class="block">
      <h3>üèÜ Top Marcas y Repuestos</h3>
      <div class="placeholder">Ranking din√°mico</div>
    </div>
  </div>

  <!-- TABLA -->
  <div class="tableWrap">

    <div class="tableActions">
      <button class="btn btnPrimary" onclick="addColumn()">+ Agregar columna</button>
    </div>

    <div class="tableScroll">
      <div id="grid" class="grid"></div>
    </div>

  </div>

</div>

<script>
const grid = document.getElementById("grid");

let columns = [
  "CODIGO 1",
  "CODIGO 2",
  "CODIGO 3",
  "DESCRIPCION",
  "MARCA",
  "STOCK DISPONIBLE"
];

const rows = 20;

/* Crear tabla */
function render(){
  grid.innerHTML = "";
  columns.forEach((name, index)=>{
    const col = document.createElement("div");
    col.className = "col";
    col.draggable = true;

    col.addEventListener("dragstart", e=>{
      e.dataTransfer.setData("col", index);
    });

    col.addEventListener("dragover", e=>e.preventDefault());

    col.addEventListener("drop", e=>{
      const from = e.dataTransfer.getData("col");
      const to = index;
      const temp = columns[from];
      columns[from] = columns[to];
      columns[to] = temp;
      render();
    });

    const header = document.createElement("div");
    header.className = "colHeader";
    header.contentEditable = true;
    header.innerText = name;
    header.onblur = ()=> columns[index] = header.innerText;

    col.appendChild(header);

    for(let r=0;r<rows;r++){
      const cell = document.createElement("div");
      cell.className = "cell";
      cell.contentEditable = true;
      col.appendChild(cell);
    }

    grid.appendChild(col);
  });
}

/* Agregar columna */
function addColumn(){
  columns.push("NUEVA COLUMNA");
  render();
}

/* Pegado desde Excel */
grid.addEventListener("paste", e=>{
  e.preventDefault();
  const text = e.clipboardData.getData("text");
  const rows = text.split("\n").map(r=>r.split("\t"));

  rows.forEach((r,rowIndex)=>{
    r.forEach((val,colIndex)=>{
      const col = grid.children[colIndex];
      if(col){
        const cell = col.children[rowIndex+1];
        if(cell) cell.innerText = val;
      }
    });
  });
});

render();
</script>

</body>
</html>

